<tool id="multigsea" name="multiGSEA" version="@TOOL_VERSION@+galaxy@SUFFIX_VERSION@">
    <description>GSEA-based pathway enrichment analysis for multi-omics data</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro='xrefs'/>
    <expand macro='requirements'/>
    <stdio>
        <regex match="Execution halted"
           source="both"
           level="fatal"
           description="Execution halted." />
        <regex match="Error in"
           source="both"
           level="fatal"
           description="An undefined error occurred, please check your input carefully and contact your administrator." />
        <regex match="Fatal error"
           source="both"
           level="fatal"
           description="An undefined error occurred, please check your input carefully and contact your administrator." />
    </stdio>
    <command><![CDATA[

        Rscript '${__tool_directory__}/multiGSEA.R'
            #if $transcriptomics_data.selector == "true"
                --transcriptomics '${transcriptomics_data.transcriptomics}'
                --transcriptome_ids $transcriptomics_data.transcriptome_ids
            #end if
            #if $proteomics_data.selector == "true"
                --proteomics '${proteomics}'
                --proteome_ids $proteomics_data.proteome_ids
            #end if
            #if $metabolomics_data.selector == "true"
                --metabolomics '${metabolomics}'
                --metabolome_ids $metabolomics_data.metabolome_idsids
            #end if
            --organism $organism
            --combine_pvalues $combine_pvalues
            --padj_method $padj_method
    ]]></command>
    <inputs>
        <conditional name="transcriptomics_data">
            <param name="selector" type="select" label="Select transcriptomics data">
                <option value="true">Enabled</option>
                <option value="false">Disabled</option>
            </param>
            <when value="true">
                <param name="transcriptomics" type="data" format="tabular" label="Transcriptomics data" 
                    help="String specifying the returned gene ID format." />
                <expand macro="macro_IDs" name="transcriptome_ids" label="Gene ID format in transcriptomics data"/>
            </when>
            <when value="false"/>
        </conditional>
        <conditional name="poteomics_data">
            <param name="selector" type="select" label="Select proteomics data">
                <option value="true">Enabled</option>
                <option value="false">Disabled</option>
            </param>
            <when value="true">
                <param name="proteomics" type="data" format="tabular" label="Proteomics data" 
                    help="String specifying the returned gene ID format" />
                <expand macro="macro_IDs" name="proteome_ids" label="Gene ID format in proteomics data"/>
            </when>
            <when value="false"/>
        </conditional>
        <conditional name="metabolomics_data">
            <param name="selector" type="select" label="Select metabolomics data">
                <option value="true">Enabled</option>
                <option value="false">Disabled</option>
            </param>
            <when value="true">
                <param name="metabolomics" type="data" format="tabular" label="Metabolomics data" 
                    help="String specifying the returned metabolite ID format." />
                <param name="metabolomics_ids" type="select" label="Metabolite ID format" 
                    help="String specifying the returned metabolite ID format.">
                    <option value="HMDB">HMDB</option>
                    <option value="CAS">CAS</option>
                    <option value="DTXCID">DTXCID</option>
                    <option value="DTXSID">DTXSID</option>
                    <option value="SID">SID</option>
                    <option value="CID">CID</option>
                    <option value="ChEBI">ChEBI</option>
                    <option value="KEGG">KEGG</option>
                    <option value="Drugbank">Drugbank</option>
                </param>
            </when>
            <when value="false"/>
        </conditional>
        <param name="organism" type="select" label="Supported organisms" help="TODO">
            <option value="hsapiens">Homo sapiens (Human)</option>
            <option value="mmusculus">Mus musculus (Mouse)</option>
            <option value="rnorvegicus">Rattus Norvegicus (Rat)</option>
            <option value="cfamiliaris">Canis lupus familiaris (Dog)</option>
            <option value="btaurus">Bos taurus (Cow)</option>
            <option value="sscrofa">Sus scrofa (Pig)</option>
            <option value="ggallus">Gallus gallus (Chicken)</option>
            <option value="xlaevis">Xenopus laevis (Flog)</option>
            <option value="drerio">Danio rerio (Zebrafish)</option>
            <option value="dmelanogaster">Drosophila melanogaster (Fruit fly)</option>
            <option value="celegans">Caenorabditis elegans (Roundworm)</option>
        </param>
        <param name="combine_pvalues" type="select" label="Combine p-values method" help="It specifies the method to combine multiple p-values. ">
            <option value="stouffer">Stouffer</option>
            <option value="fisher">Fisher</option>
            <option value="edgington">Edgington</option>
        </param>
        <param name="padj_method" type="select" label="P-values correction method">
            <option value="holm">Holm</option>
            <option value="hochberg">Hochberg</option>
            <option value="hommel">Hommel</option>
            <option value="bonferroni">Bonferroni</option>
            <option value="BH" selected="true">BH</option>
            <option value="BY">BY</option>
        </param>


    </inputs>
    <outputs>

    </outputs>
    <tests>

    </tests>
    <help><![CDATA[

    ]]></help>
    <expand macro="citations" />
</tool>
